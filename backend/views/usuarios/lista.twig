{% extends '../layout.twig' %}
{% block style %}
    <style>

    </style>
{% endblock %}
{% block body %}
    <div class="row">

        <h3>Lista de usuarios</h3>
    </div>

    <div class="row">
        <form class="form-inline" action="/users/create" method="post" id="form-user">
            <div class="form-group mb-2">
                <label for="staticEmail2" >Username</label>
                <input type="text" class="form-control-plaintext" id="username" value="" name="username" placeholder="Escriba el nombre de usuario">
            </div>
            <div class="form-group mb-2">
                <label for="staticEmail2" >Nombre</label>
                <input type="text" class="form-control-plaintext" id="name" value="" name="name" placeholder="Escriba su nombre">
            </div>
            <div class="form-group mb-2">
                <label for="staticEmail2" >Email</label>
                <input type="text" class="form-control-plaintext" id="password" value="" name="email" placeholder="Escriba contraseña">
            </div>
            <div class="form-group mb-2">
                <label for="inputPassword2">Contraseña</label>
                <input type="password" class="form-control-plaintext" id="inputPassword2" name="password" placeholder="Password">
            </div>
            <button type="submit" class="btn btn-primary mb-2">Agregar</button>
        </form>
    </div>

    <div class="row">
        <div id="gridbox" style="width:100%; height:400px; background-color:white;"></div>
    </div>
    <script>
        var myGrid;
        $(function () {
            $('#form-user').submit(function (e) {
                e.preventDefault();

                $.post($(this).attr('action'), $(this).serialize(), function (data) {
                    document.getElementById("form-user").reset();
                    myGrid.clearAll();
                    myGrid.load("/users/data", "json");
                    alert("Usuario creado "+data.msg)
                }).fail(function (err) {
                    console.error("ocurrio un error"+err.msg)
                });
            });

        });


        myGrid = new dhtmlXGridObject('gridbox');
        myGrid.setImagePath("dhtmlx/codebase/imgs/");
        myGrid.setHeader("Nombre de usuario,Nombre,Email,Password");
        myGrid.attachHeader("#text_filter,#text_filter,#text_filter,#text_filter");
        myGrid.setInitWidths("*,*,*,*");
        myGrid.enableAutoWidth(true);
        myGrid.setColAlign("left,center,left,left");
        myGrid.setColTypes("ro,ro,ro,ro");
        myGrid.setColSorting("na,na,str,str");
        myGrid.init();
        myGrid.enableSmartRendering(true);
        myGrid.load("/users/data", "json");

    </script>
{% endblock %}
